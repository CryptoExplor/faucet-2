<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
Â  <title>SuperChain Faucet</title>

Â  <!-- Tailwind CSS -->
Â  <script src="https://cdn.tailwindcss.com"></script>
Â  <style>
Â  Â  /* Custom styles for the app */
Â  Â  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
Â  Â  body {
Â  Â  Â  font-family: 'Inter', sans-serif;
Â  Â  Â  font-size: 16px;
Â  Â  }
Â  Â  .select-network {
Â  Â  Â  background-color: #333;
Â  Â  Â  border: 1px solid #444;
Â  Â  Â  color: white;
Â  Â  Â  padding: 0.5rem;
Â  Â  Â  border-radius: 8px;
Â  Â  }
Â  Â  .spinner {
Â  Â  Â  border: 2px solid rgba(255, 255, 255, 0.2);
Â  Â  Â  border-top: 2px solid #fff;
Â  Â  Â  border-radius: 50%;
Â  Â  Â  width: 16px;
Â  Â  Â  height: 16px;
Â  Â  Â  animation: spin 1s linear infinite;
Â  Â  }
Â  Â  @keyframes spin {
Â  Â  Â  0% { transform: rotate(0deg); }
Â  Â  Â  100% { transform: rotate(360deg); }
Â  Â  }
Â  Â  .modal-overlay {
Â  Â  Â  background-color: rgba(0, 0, 0, 0.75);
Â  Â  Â  z-index: 50;
Â  Â  }
Â  Â  .modal-content {
Â  Â  Â  z-index: 60;
Â  Â  }
Â  </style>

Â  <!-- Farcaster Mini App Metadata from user-provided frame.html -->
Â  <meta property="fc:miniapp" content='{
Â  Â  "version": "1",
Â  Â  "imageUrl": "https://faucet-2.vercel.app/frame-image.jpg",
Â  Â  "button": {
Â  Â  Â  "title": "ðŸš° Claim Test ETH (Unofficial)",
Â  Â  Â  "action": {
Â  Â  Â  Â  "type": "launch_frame",
Â  Â  Â  Â  "name": "SuperChain Faucet",
Â  Â  Â  Â  "url": "https://faucet-2.vercel.app/",
Â  Â  Â  Â  "splashImageUrl": "/public/frame-image.svg",
Â  Â  Â  Â  "splashBackgroundColor": "#f8fafc"
Â  Â  Â  }
Â  Â  }
Â  }' />

Â  <meta name="description" content="Unofficial faucet for SuperChain testnets. Claim test ETH with Gitcoin Passport verification.">
Â  <meta property="og:title" content="SuperChain Faucet (Unofficial)">
Â  <meta property="og:description" content="Unofficial faucet for SuperChain development. Get test ETH with Gitcoin Passport score â‰¥ 10.">
Â  <meta property="og:image" content="/public/frame-image.svg">
Â  <meta property="og:url" content="/index.html">
Â  <meta name="twitter:card" content="summary_large_image">
</head>
<body class="bg-[#111] text-white flex flex-col items-center min-h-screen p-4">

Â  <!-- App Header Card -->
Â  <div class="bg-[#222] p-8 rounded-xl text-center w-full max-w-sm mb-5">
Â  Â  <h1 class="text-2xl font-bold">SuperChain Faucet</h1>
Â  Â  <p class="mt-2 text-gray-400">Claim test ETH on a variety of Superchain networks!</p>
Â  </div>
Â  
Â  <!-- Wallet Connection Status and button -->
Â  <div class="bg-[#222] p-6 rounded-xl w-full max-w-sm mb-5 text-center">
Â  Â  <h2 class="text-xl font-semibold mb-3">Wallet Status</h2>
Â  Â  <div id="walletConnectedDisplay" class="flex items-center justify-center gap-2 mb-4 hidden">
Â  Â  Â  <span id="connectedAccount" class="font-mono text-xs md:text-sm"></span>
Â  Â  Â  <button id="disconnectButton" class="text-sm px-3 py-1 bg-gray-600 rounded-lg hover:bg-red-500 transition-colors">Disconnect</button>
Â  Â  </div>
Â  Â  <button id="connectButton" class="px-8 py-4 text-xl font-bold rounded-lg bg-white text-black transition-transform transform hover:scale-105">
Â  Â  Â  Connect Wallet
Â  Â  </button>
Â  </div>

Â  <!-- Network Selection -->
Â  <div class="bg-[#222] p-6 rounded-xl w-full max-w-sm mb-5 text-center">
Â  Â  <h2 class="text-xl font-semibold mb-3">Select Network</h2>
Â  Â  <select id="networkSelector" class="select-network w-full">
Â  Â  Â  <!-- Options will be populated by JavaScript -->
Â  Â  </select>
Â  </div>
Â  
Â  <!-- Claim Requirements Card -->
Â  <div class="bg-[#222] p-6 rounded-xl w-full max-w-sm mb-5">
Â  Â  <h2 class="text-xl font-semibold mb-3">Claim Requirements</h2>
Â  Â  
Â  Â  <!-- Gitcoin Passport Status -->
Â  Â  <div class="flex items-center justify-between py-2 border-b border-gray-700">
Â  Â  Â  <span class="flex items-center gap-2">
Â  Â  Â  Â  Gitcoin Passport Score
Â  Â  Â  </span>
Â  Â  Â  <div id="passportStatus">
Â  Â  Â  Â  <!-- Score will be rendered here by JavaScript -->
Â  Â  Â  </div>
Â  Â  </div>
Â  Â  
Â  Â  <!-- Rate Limit Status -->
Â  Â  <div class="flex items-center justify-between py-2">
Â  Â  Â  <span class="flex items-center gap-2">
Â  Â  Â  Â  Rate Limit
Â  Â  Â  </span>
Â  Â  Â  <div id="rateLimitStatus">
Â  Â  Â  Â  <!-- Status will be rendered here by JavaScript -->
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>
Â  
Â  <!-- Last Claim History Card -->
Â  <div class="bg-[#222] p-6 rounded-xl w-full max-w-sm mb-5">
Â  Â  Â  <h2 class="text-xl font-semibold mb-3">Last Claim</h2>
Â  Â  Â  <div id="lastClaimDetails" class="text-sm text-gray-400">
Â  Â  Â  Â  Â  No previous claims found.
Â  Â  Â  </div>
Â  </div>

Â  <!-- Claim Button -->
Â  <button id="claimButton" class="px-8 py-4 text-xl font-bold rounded-lg mb-3 bg-white text-black transition-transform transform hover:scale-105">
Â  Â  CLAIM ETH
Â  </button>

Â  <!-- Status Message Box -->
Â  <div id="statusBox" class="px-3 py-2 rounded-lg text-sm w-full max-w-sm text-center"></div>

Â  <!-- Wallet Connection Modal -->
Â  <div id="walletModal" class="fixed inset-0 hidden items-center justify-center p-4 modal-overlay">
Â  Â  <div class="bg-[#222] p-8 rounded-xl w-full max-w-sm modal-content">
Â  Â  Â  <h2 class="text-xl font-bold text-center mb-6">Connect a Wallet</h2>
Â  Â  Â  <div class="flex flex-col gap-4">
Â  Â  Â  Â  <!-- New button for Injected/Browser Wallets -->
Â  Â  Â  Â  <button id="injectedConnectBtn" class="flex items-center justify-center gap-3 px-6 py-3 bg-gray-500 hover:bg-gray-600 transition-colors text-white rounded-lg font-semibold">
Â  Â  Â  Â  Â  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M11 1.94c-5.06 0-9.17 4.11-9.17 9.17s4.11 9.17 9.17 9.17 9.17-4.11 9.17-9.17S16.06 1.94 11 1.94zm0 16.51c-4.04 0-7.34-3.3-7.34-7.34s3.3-7.34 7.34-7.34 7.34 3.3 7.34 7.34-3.3 7.34-7.34 7.34z"/><path d="M11 14.89c-.66 0-1.2-.54-1.2-1.2V9.89c0-.66.54-1.2 1.2-1.2s1.2.54 1.2 1.2v3.8c0 .66-.54 1.2-1.2 1.2zM11 7.42c-.28 0-.5.22-.5.5v2.85c0 .28.22.5.5.5s.5-.22.5-.5V7.92c0-.28-.22-.5-.5-.5z"/><path d="M12.7 16.82h-3.4c-.15 0-.2-.1-.1-.2l1.7-2.94c.1-.15.25-.15.35 0l1.7 2.94c.1.1.05.2-.1.2z"/></svg>
Â  Â  Â  Â  Â  Connect Browser Wallet
Â  Â  Â  Â  </button>
Â  Â  Â  Â  <button id="farcasterConnectBtn" class="flex items-center justify-center gap-3 px-6 py-3 bg-blue-600 hover:bg-blue-700 transition-colors text-white rounded-lg font-semibold">
Â  Â  Â  Â  Â  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="text-white"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm3.2 13.92c-.1.14-.24.26-.44.34a.7.7 0 0 1-.3.08c-.14 0-.28-.02-.4-.08a.95.95 0 0 1-.36-.26c-.1-.1-.14-.2-.16-.3a.35.35 0 0 0-.2-.2c-.1 0-.16.02-.24.08-.08.06-.12.1-.14.16a.42.42 0 0 1-.16.14c-.06.04-.12.06-.2.06a.35.35 0 0 1-.2-.08c-.1-.08-.16-.18-.16-.3s-.04-.32-.12-.48c-.06-.12-.12-.24-.16-.38a.86.86 0 0 0-.16-.3c-.04-.08-.12-.12-.22-.12h-1.42a.58.58 0 0 0-.48.24l-3.2 3.82a.25.25 0 0 1-.2.08h-.02a.25.25 0 0 1-.2-.08.43.43 0 0 1-.08-.24c0-.1.04-.2.12-.3.4-.48.72-.88 1.04-1.28a3.1 3.1 0 0 0 .66-.9c.12-.22.2-.4.26-.54a.63.63 0 0 0 .1-.26c.02-.08 0-.14-.06-.16a.38.38 0 0 1-.1-.06c-.06-.02-.1-.02-.16 0s-.12.04-.2.1a1.26 1.26 0 0 1-.24.2c-.1.12-.2.18-.3.18-.12 0-.2-.04-.26-.14-.06-.1-.06-.2-.02-.34a.6.6 0 0 1 .14-.24c.06-.1.16-.18.28-.24.12-.08.24-.12.38-.12.16 0 .3.04.42.12.14.08.24.2.32.34.08.12.14.28.18.46.04.16.06.3.06.4s-.02.26-.06.4-.08.26-.14.4c-.1.2-.18.38-.28.56l-.16.3a.26.26 0 0 0-.02.16c0 .1.04.16.12.2a.37.37 0 0 0 .22.04.3.3 0 0 0 .22-.08c.08-.08.14-.18.18-.3s.06-.24.08-.38c.16-.6.38-1.12.66-1.54.26-.42.54-.78.84-1.08.28-.3.56-.54.82-.72.28-.18.5-.26.68-.26h1.24a.5.5 0 0 1 .32.1.2.2 0 0 1 .14.28c-.02.04-.08.1-.18.16-.12.06-.24.1-.36.14a1.86 1.86 0 0 0-.28.08.38.38 0 0 0-.12.04c-.06.04-.1.08-.1.14a.2.2 0 0 0 .04.14c.06.04.12.08.2.14.08.06.14.12.2.18.06.06.1.1.12.14.04.06.06.12.06.2c0 .12-.04.22-.1.3-.06.08-.16.14-.28.2a1.86 1.86 0 0 0-.32.18c-.1.06-.16.1-.2.12-.06.04-.1.08-.1.12-.02.04 0 .08.04.12.04.04.08.08.14.12.06.04.12.08.2.14.14.12.26.24.36.38.12.14.22.28.3.4s.14.24.18.38c.04.14.06.26.06.36v.44a.42.42 0 0 0 .14.32c.08.08.18.12.3.12.1 0 .2-.04.3-.12.14-.1.26-.2.38-.34a.78.78 0 0 0 .34-.44c.06-.16.08-.28.08-.34v-3.76a.42.42 0 0 0-.14-.32c-.08-.08-.18-.12-.3-.12-.12 0-.22.04-.3.12-.1.1-.16.22-.16.36v.38c0 .12 0 .22.02.3a.6.6 0 0 1 .06.26c.04.1.08.18.14.24.08.1.18.14.3.14.1 0 .2-.04.3-.12.1-.08.16-.2.16-.36V9.44c0-.12.04-.22.12-.3.08-.1.18-.16.3-.18h.08a.5.5 0 0 1 .32.16c.1.1.16.22.16.36V14.1c0 .12-.02.24-.06.38z"></path></svg>
Â  Â  Â  Â  Â  Connect with Farcaster
Â  Â  Â  Â  </button>
Â  Â  Â  Â  <button id="walletConnectBtn" class="flex items-center justify-center gap-3 px-6 py-3 bg-sky-500 hover:bg-sky-600 transition-colors text-white rounded-lg font-semibold">
Â  Â  Â  Â  Â  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M11 1.94c-5.06 0-9.17 4.11-9.17 9.17s4.11 9.17 9.17 9.17 9.17-4.11 9.17-9.17S16.06 1.94 11 1.94zm0 16.51c-4.04 0-7.34-3.3-7.34-7.34s3.3-7.34 7.34-7.34 7.34 3.3 7.34 7.34-3.3 7.34-7.34 7.34z"/><path d="M11 14.89c-.66 0-1.2-.54-1.2-1.2V9.89c0-.66.54-1.2 1.2-1.2s1.2.54 1.2 1.2v3.8c0 .66-.54 1.2-1.2 1.2zM11 7.42c-.28 0-.5.22-.5.5v2.85c0 .28.22.5.5.5s.5-.22.5-.5V7.92c0-.28-.22-.5-.5-.5z"/><path d="M12.7 16.82h-3.4c-.15 0-.2-.1-.1-.2l1.7-2.94c.1-.15.25-.15.35 0l1.7 2.94c.1.1.05.2-.1.2z"/></svg>
Â  Â  Â  Â  Â  Connect with WalletConnect
Â  Â  Â  Â  </button>
Â  Â  Â  </div>
Â  Â  Â  <button id="closeModalBtn" class="mt-6 px-4 py-2 text-sm text-center w-full bg-gray-700 hover:bg-gray-600 transition-colors rounded-lg">Close</button>
Â  Â  </div>
Â  </div>
Â  
Â  <script type="module">
Â  Â  import {
Â  Â  Â  createConfig,
Â  Â  Â  connect,
Â  Â  Â  disconnect,
Â  Â  Â  http,
Â  Â  Â  getAccount,
Â  Â  Â  watchAccount
Â  Â  } from 'https://esm.sh/@wagmi/core@2.11.7';
Â  Â  import { injected } from 'https://esm.sh/@wagmi/connectors@7.0.0/injected';
Â  Â  import { farcasterMiniApp } from 'https://esm.sh/@farcaster/miniapp-wagmi-connector';
Â  Â  import { WalletConnectConnector } from 'https://esm.sh/@wagmi/connectors@7.0.0/walletConnect';
Â  Â  import { sdk } from 'https://esm.sh/@farcaster/miniapp-sdk';
Â  Â  
Â  Â  // Import Lucide icons as SVG strings for direct insertion
Â  Â  const checkIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check-circle-2 text-green-500"><path d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2Z"/><path d="m9 12 2 2 4-4"/></svg>`;
Â  Â  const crossIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x-circle text-red-500"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>`;
Â  Â  const clockIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>`;
Â  Â  const spinner = `<div class="spinner"></div>`;
Â  Â  const warningIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-alert-circle text-yellow-500"><circle cx="12" cy="12" r="10"/><path d="M12 8v4"/><path d="M12 16h.01"/></svg>`;

Â  Â  // --- State Variables ---
Â  Â  let account = null;
Â  Â  let isConnected = false;
Â  Â  let passportData = null;
Â  Â  let rateLimitData = null;
Â  Â  let isClaiming = false;
Â  Â  let isRequirementsLoading = false;
Â  Â  let selectedNetwork = null;
Â  Â  let wagmiConfig = null;
Â  Â  let lastClaimData = null;
Â  Â  let isFarcasterEnv = false;

Â  Â  // --- Configuration for Deployment ---
Â  Â  // IMPORTANT: Replace these with your actual values from the .env file before deploying!
Â  Â  const PASSPORT_THRESHOLD = 10;
Â  Â  const RATE_LIMIT_HOURS = 24;
Â  Â  const WALLETCONNECT_PROJECT_ID = 'YOUR_WALLETCONNECT_PROJECT_ID'; // Replace with your Project ID
Â  Â  const UPSTASH_REST_URL = 'https://[YOUR_REDIS_URL].upstash.io'; // Replace with the value of UPSTASH_REDIS_REST_URL
Â  Â  const UPSTASH_REST_TOKEN = '[YOUR_REDIS_TOKEN]'; // Replace with the value of UPSTASH_REDIS_REST_TOKEN
Â  Â  // These would be your serverless function endpoints
Â  Â  const PASSPORT_API_URL = '/api/passport-score'; 
Â  Â  const CLAIM_API_URL = '/api/claim-eth';

Â  Â  // --- Network Data (Updated with id) ---
Â  Â  const SUPPORTED_NETWORKS = [
Â  Â  Â  { id: "base-sepolia", name: "Base Sepolia", chainId: 84532, rpcUrl: "https://sepolia.base.org", nativeCurrency: "ETH", explorerUrl: "https://sepolia.basescan.org", faucetAmount: "0.001", isActive: true },
Â  Â  Â  { id: "optimism-sepolia", name: "Optimism Sepolia", chainId: 11155420, rpcUrl: "https://sepolia.optimism.io", nativeCurrency: "ETH", explorerUrl: "https://sepolia-optimism.etherscan.io", faucetAmount: "0.001", isActive: true },
Â  Â  Â  { id: "arbitrum-sepolia", name: "Arbitrum Sepolia", chainId: 421614, rpcUrl: "https://sepolia-rollup.arbitrum.io/rpc", nativeCurrency: "ETH", explorerUrl: "https://sepolia.arbiscan.io", faucetAmount: "0.001", isActive: true },
Â  Â  Â  { id: "ink-sepolia", name: "Ink Sepolia", chainId: 763373, rpcUrl: "https://rpc-gel-sepolia.inkonchain.com", nativeCurrency: "ETH", explorerUrl: "https://explorer-sepolia.inkonchain.com", faucetAmount: "0.001", isActive: true },
Â  Â  Â  { id: "mode-sepolia", name: "Mode Sepolia", chainId: 919, rpcUrl: "https://sepolia.mode.network", nativeCurrency: "ETH", explorerUrl: "https://sepolia.explorer.mode.network", faucetAmount: "0.001", isActive: true },
Â  Â  Â  { id: "zora-sepolia", name: "Zora Sepolia", chainId: 999999999, rpcUrl: "https://sepolia.rpc.zora.energy", nativeCurrency: "ETH", explorerUrl: "https://sepolia.explorer.zora.energy", faucetAmount: "0.001", isActive: true },
Â  Â  Â  { id: "unichain-sepolia", name: "Unichain Sepolia", chainId: 1301, rpcUrl: "https://sepolia.unichain.org", nativeCurrency: "ETH", explorerUrl: "https://sepolia.uniscan.xyz", faucetAmount: "0.001", isActive: true },
Â  Â  Â  { id: "blast-sepolia", name: "Blast Sepolia", chainId: 168587773, rpcUrl: "https://sepolia.blast.io", nativeCurrency: "ETH", explorerUrl: "https://testnet.blastscan.io", faucetAmount: "0.001", isActive: true },
Â  Â  Â  { id: "frax-sepolia", name: "Frax Sepolia", chainId: 2522, rpcUrl: "https://rpc.testnet.frax.com", nativeCurrency: "frxETH", explorerUrl: "https://holesky.fraxscan.com", faucetAmount: "0.001", isActive: true },
Â  Â  Â  { id: "cyber-sepolia", name: "Cyber Sepolia", chainId: 111557560, rpcUrl: "https://cyber-testnet.alt.technology", nativeCurrency: "ETH", explorerUrl: "https://testnet.cyberscan.co", faucetAmount: "0.001", isActive: true },
Â  Â  ];
Â  Â  
Â  Â  // Get all active networks
Â  Â  const getActiveNetworks = () => SUPPORTED_NETWORKS.filter(n => n.isActive);
Â  Â  // Get network by chain ID
Â  Â  const getNetworkByChainId = (chainId) => SUPPORTED_NETWORKS.find(n => n.chainId === chainId) || null;
Â  Â  // Get network by ID
Â  Â  const getNetworkById = (id) => SUPPORTED_NETWORKS.find(n => n.id === id) || null;

Â  Â  // --- DOM Elements ---
Â  Â  const networkSelector = document.getElementById('networkSelector');
Â  Â  const passportStatus = document.getElementById('passportStatus');
Â  Â  const rateLimitStatus = document.getElementById('rateLimitStatus');
Â  Â  const claimButton = document.getElementById('claimButton');
Â  Â  const statusBox = document.getElementById('statusBox');
Â  Â  const lastClaimDetails = document.getElementById('lastClaimDetails');
Â  Â  const connectButton = document.getElementById('connectButton');
Â  Â  const disconnectButton = document.getElementById('disconnectButton');
Â  Â  const walletModal = document.getElementById('walletModal');
Â  Â  const injectedConnectBtn = document.getElementById('injectedConnectBtn');
Â  Â  const farcasterConnectBtn = document.getElementById('farcasterConnectBtn');
Â  Â  const walletConnectBtn = document.getElementById('walletConnectBtn');
Â  Â  const closeModalBtn = document.getElementById('closeModalBtn');
Â  Â  const walletConnectedDisplay = document.getElementById('walletConnectedDisplay');
Â  Â  const connectedAccountSpan = document.getElementById('connectedAccount');

Â  Â  // --- Utility Functions ---

Â  Â  // Function to set the status message in the UI
Â  Â  const setStatus = (msg, type = '') => {
Â  Â  Â  statusBox.innerHTML = msg;
Â  Â  Â  statusBox.className = `px-3 py-2 rounded-lg text-sm w-full max-w-sm text-center ${
Â  Â  Â  Â  type === 'success' ? 'bg-blue-700' :
Â  Â  Â  Â  type === 'error' ? 'bg-red-700' : 'bg-yellow-700'
Â  Â  Â  }`;
Â  Â  };
Â  Â  
Â  Â  // Function to format the remaining time for the UI
Â  Â  const formatTimeRemaining = (ms) => {
Â  Â  Â  if (ms <= 0) return '0 minutes';
Â  Â  Â  const seconds = Math.floor(ms / 1000);
Â  Â  Â  const minutes = Math.floor(seconds / 60);
Â  Â  Â  const hours = Math.floor(minutes / 60);
Â  Â  Â  const days = Math.floor(hours / 24);

Â  Â  Â  let result = [];
Â  Â  Â  if (days > 0) result.push(`${days} days`);
Â  Â  Â  if (hours > 0) result.push(`${hours % 24} hours`);
Â  Â  Â  if (minutes > 0) result.push(`${minutes % 60} minutes`);
Â  Â  Â  if (result.length === 0) result.push('less than a minute');

Â  Â  Â  return result.join(', ');
Â  Â  };

Â  Â  // --- Upstash/Server-side API Interaction Functions ---

Â  Â  // Function to simulate a fetch call to a serverless function for passport data
Â  Â  const fetchPassportData = async (address) => {
Â  Â  Â  // In a real app, this would be a fetch call to your serverless function
Â  Â  Â  // that interacts with the Gitcoin Passport API.
Â  Â  Â  // Example: `const response = await fetch(`${PASSPORT_API_URL}?address=${address}`);`
Â  Â  Â  // For this example, we'll simulate the response.
Â  Â  Â  return new Promise((resolve, reject) => {
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  const score = Math.random() * 20; // Simulating a score
Â  Â  Â  Â  Â  const data = {
Â  Â  Â  Â  Â  Â  score: score,
Â  Â  Â  Â  Â  Â  address: address,
Â  Â  Â  Â  Â  Â  passing_score: score >= PASSPORT_THRESHOLD,
Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  resolve(data);
Â  Â  Â  Â  }, 1000);
Â  Â  Â  });
Â  Â  };
Â  Â  
Â  Â  // Function to load last claim data from Upstash using REST API
Â  Â  const loadLastClaimData = async () => {
Â  Â  Â  const key = `faucet:claim:${account}:${selectedNetwork.id}`;
Â  Â  Â  const url = `${UPSTASH_REST_URL}/GET/${key}`;
Â  Â  Â  try {
Â  Â  Â  Â  const response = await fetch(url, {
Â  Â  Â  Â  Â  method: 'GET',
Â  Â  Â  Â  Â  headers: {
Â  Â  Â  Â  Â  Â  'Authorization': `Bearer ${UPSTASH_REST_TOKEN}`
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  Â  Â  const result = await response.json();
Â  Â  Â  Â  if (result.result) {
Â  Â  Â  Â  Â  return JSON.parse(result.result);
Â  Â  Â  Â  }
Â  Â  Â  Â  return null;
Â  Â  Â  } catch (e) {
Â  Â  Â  Â  console.error('Failed to load claim data from Upstash:', e);
Â  Â  Â  Â  return null;
Â  Â  Â  }
Â  Â  };
Â  Â  
Â  Â  // Function to save last claim data to Upstash using REST API
Â  Â  const saveLastClaimData = async (claim) => {
Â  Â  Â  const key = `faucet:claim:${account}:${selectedNetwork.id}`;
Â  Â  Â  // Expiration time in seconds
Â  Â  Â  const expirationSeconds = RATE_LIMIT_HOURS * 60 * 60; 
Â  Â  Â  const value = JSON.stringify(claim);
Â  Â  Â  const url = `${UPSTASH_REST_URL}/SET/${key}/${value}?EX=${expirationSeconds}`;
Â  Â  Â  
Â  Â  Â  try {
Â  Â  Â  Â  const response = await fetch(url, {
Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  headers: {
Â  Â  Â  Â  Â  Â  'Authorization': `Bearer ${UPSTASH_REST_TOKEN}`
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  Â  Â  return await response.json();
Â  Â  Â  } catch (e) {
Â  Â  Â  Â  console.error('Failed to save claim data to Upstash:', e);
Â  Â  Â  }
Â  Â  };

Â  Â  // --- UI Update Function ---
Â  Â  const updateUI = () => {
Â  Â  Â  
Â  Â  Â  // Update wallet connection display
Â  Â  Â  if (isConnected) {
Â  Â  Â  Â  connectButton.classList.add('hidden');
Â  Â  Â  Â  walletConnectedDisplay.classList.remove('hidden');
Â  Â  Â  Â  connectedAccountSpan.textContent = `Connected: ${account.slice(0, 6)}...${account.slice(-4)}`;
Â  Â  Â  } else {
Â  Â  Â  Â  connectButton.classList.remove('hidden');
Â  Â  Â  Â  walletConnectedDisplay.classList.add('hidden');
Â  Â  Â  Â  passportStatus.innerHTML = `<span class="text-red-500 font-semibold">N/A (Failed)</span>`;
Â  Â  Â  Â  rateLimitStatus.innerHTML = `<span class="text-red-500 font-semibold">N/A (Failed)</span>`;
Â  Â  Â  }

Â  Â  Â  // Disable farcaster button if not in a Farcaster environment
Â  Â  Â  if (!isFarcasterEnv) {
Â  Â  Â  Â  farcasterConnectBtn.disabled = true;
Â  Â  Â  Â  farcasterConnectBtn.classList.add('opacity-50', 'cursor-not-allowed');
Â  Â  Â  Â  farcasterConnectBtn.title = 'This button only works inside a Farcaster Mini App.';
Â  Â  Â  } else {
Â  Â  Â  Â  farcasterConnectBtn.disabled = false;
Â  Â  Â  Â  farcasterConnectBtn.classList.remove('opacity-50', 'cursor-not-allowed');
Â  Â  Â  Â  farcasterConnectBtn.title = '';
Â  Â  Â  }
Â  Â  Â  

Â  Â  Â  if (isRequirementsLoading) {
Â  Â  Â  Â  passportStatus.innerHTML = spinner;
Â  Â  Â  Â  rateLimitStatus.innerHTML = spinner;
Â  Â  Â  } else if (isConnected) {
Â  Â  Â  Â  // Passport Status
Â  Â  Â  Â  if (passportData) {
Â  Â  Â  Â  Â  if (passportData.passing_score) {
Â  Â  Â  Â  Â  Â  passportStatus.innerHTML = `<span class="text-green-500 font-semibold">${passportData.score.toFixed(2)} (Passed)</span>`;
Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  passportStatus.innerHTML = `<span class="text-red-500 font-semibold">${passportData.score.toFixed(2)} (Failed)</span>`;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  passportStatus.innerHTML = `<span class="text-red-500 font-semibold">N/A (Failed)</span>`;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Rate Limit Status
Â  Â  Â  Â  if (rateLimitData?.isRateLimited) {
Â  Â  Â  Â  Â  rateLimitStatus.innerHTML = `<span class="flex items-center gap-1 text-red-500 font-semibold">${clockIcon} ${formatTimeRemaining(rateLimitData.remainingTime)}</span>`;
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  rateLimitStatus.innerHTML = `<span class="text-green-500 font-semibold">Available</span>`;
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  Â  
Â  Â  Â  const isButtonDisabled = 
Â  Â  Â  Â  !isConnected || 
Â  Â  Â  Â  isClaiming || 
Â  Â  Â  Â  isRequirementsLoading ||
Â  Â  Â  Â  (passportData && !passportData.passing_score) ||
Â  Â  Â  Â  (rateLimitData && rateLimitData.isRateLimited);

Â  Â  Â  claimButton.disabled = isButtonDisabled;
Â  Â  Â  if (isButtonDisabled) {
Â  Â  Â  Â  claimButton.className = 'px-8 py-4 text-xl font-bold rounded-lg mb-3 bg-gray-600 text-gray-400 cursor-not-allowed';
Â  Â  Â  } else {
Â  Â  Â  Â  claimButton.className = 'px-8 py-4 text-xl font-bold rounded-lg mb-3 bg-white text-black transition-transform transform hover:scale-105';
Â  Â  Â  }
Â  Â  Â  
Â  Â  Â  // Update button text based on state
Â  Â  Â  if (isClaiming) {
Â  Â  Â  Â  claimButton.innerText = 'Claimingâ€¦';
Â  Â  Â  } else if (!isConnected) {
Â  Â  Â  Â  claimButton.innerText = 'CONNECT WALLET TO CONTINUE';
Â  Â  Â  } else if (isRequirementsLoading) {
Â  Â  Â  Â  claimButton.innerText = 'Checking Requirementsâ€¦';
Â  Â  Â  } else if (passportData && !passportData.passing_score) {
Â  Â  Â  Â  claimButton.innerText = `Need score â‰¥ ${PASSPORT_THRESHOLD}`;
Â  Â  Â  } else if (rateLimitData && rateLimitData.isRateLimited) {
Â  Â  Â  Â  claimButton.innerText = `Try again in ${formatTimeRemaining(rateLimitData.remainingTime)}`;
Â  Â  Â  } else {
Â  Â  Â  Â  claimButton.innerText = `CLAIM ETH`;
Â  Â  Â  }
Â  Â  Â  
Â  Â  Â  // Last Claim Display
Â  Â  Â  if (lastClaimData) {
Â  Â  Â  Â  Â  const claimedAt = new Date(lastClaimData.claimedAt);
Â  Â  Â  Â  Â  lastClaimDetails.innerHTML = `
Â  Â  Â  Â  Â  Â  <p>Amount: ${lastClaimData.amount} ${getNetworkById(lastClaimData.networkId)?.nativeCurrency}</p>
Â  Â  Â  Â  Â  Â  <p>Timestamp: ${claimedAt.toLocaleString()}</p>
Â  Â  Â  Â  Â  Â  <p>Tx Hash: <a href="${getNetworkById(lastClaimData.networkId)?.explorerUrl}/tx/${lastClaimData.txHash}" target="_blank" class="underline">${lastClaimData.txHash.slice(0, 10)}...${lastClaimData.txHash.slice(-8)}</a></p>
Â  Â  Â  Â  Â  `;
Â  Â  Â  } else {
Â  Â  Â  Â  Â  lastClaimDetails.textContent = "No previous claims found.";
Â  Â  Â  }
Â  Â  };

Â  Â  // --- Main App Logic ---
Â  Â  const updateWagmiConfig = (network) => {
Â  Â  Â  Â  // Find the chain object in wagmi's supported chains
Â  Â  Â  Â  const chain = { 
Â  Â  Â  Â  Â  id: network.chainId,
Â  Â  Â  Â  Â  name: network.name,
Â  Â  Â  Â  Â  nativeCurrency: { name: network.nativeCurrency, symbol: network.nativeCurrency, decimals: 18 },
Â  Â  Â  Â  Â  rpcUrls: { default: { http: [network.rpcUrl] } },
Â  Â  Â  Â  Â  blockExplorers: { default: { name: 'Explorer', url: network.explorerUrl } },
Â  Â  Â  Â  Â  testnet: true
Â  Â  Â  Â  };
Â  Â  Â  
Â  Â  Â  Â  // Create wagmi config with all three connectors
Â  Â  Â  Â  wagmiConfig = createConfig({
Â  Â  Â  Â  Â  Â  chains: [chain],
Â  Â  Â  Â  Â  Â  transports: { [network.chainId]: http() },
Â  Â  Â  Â  Â  Â  connectors: [
Â  Â  Â  Â  Â  Â  Â  injected(), // New: Injected wallet connector
Â  Â  Â  Â  Â  Â  Â  farcasterMiniApp(),
Â  Â  Â  Â  Â  Â  Â  new WalletConnectConnector({ projectId: WALLETCONNECT_PROJECT_ID, showQrModal: true })
Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  });
Â  Â  Â  Â  console.log("Wagmi config updated for:", network.name);
Â  Â  };

Â  Â  // Fetches passport and rate limit data
Â  Â  const fetchRequirements = async () => {
Â  Â  Â  Â  if (!isConnected) {
Â  Â  Â  Â  Â  // Clear previous data when not connected
Â  Â  Â  Â  Â  passportData = null;
Â  Â  Â  Â  Â  rateLimitData = null;
Â  Â  Â  Â  Â  lastClaimData = null;
Â  Â  Â  Â  Â  updateUI();
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  isRequirementsLoading = true;
Â  Â  Â  Â  setStatus('Checking requirements...', 'info');
Â  Â  Â  Â  updateUI();

Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  // Fetch passport data from your serverless function
Â  Â  Â  Â  Â  Â  passportData = await fetchPassportData(account);
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // Check rate limit from your Upstash instance
Â  Â  Â  Â  Â  Â  const lastClaim = await loadLastClaimData();
Â  Â  Â  Â  Â  Â  const now = new Date();
Â  Â  Â  Â  Â  Â  lastClaimData = lastClaim;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  if (lastClaim) {
Â  Â  Â  Â  Â  Â  Â  Â  const claimedAt = new Date(lastClaim.claimedAt).getTime();
Â  Â  Â  Â  Â  Â  Â  Â  const nextClaimTime = claimedAt + RATE_LIMIT_HOURS * 60 * 60 * 1000;
Â  Â  Â  Â  Â  Â  Â  Â  const remainingTime = nextClaimTime - now.getTime();
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  if (remainingTime > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  rateLimitData = {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  isRateLimited: true,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  nextClaimTime: nextClaimTime,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  remainingTime: remainingTime
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  rateLimitData = {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  isRateLimited: false,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  nextClaimTime: null,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  remainingTime: 0
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  rateLimitData = {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  isRateLimited: false,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  nextClaimTime: null,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  remainingTime: 0
Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  setStatus('Requirements checked. Ready to claim.', 'success');
Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  console.error('Failed to check faucet requirements', e);
Â  Â  Â  Â  Â  Â  setStatus('Failed to check faucet requirements. Please try again.', 'error');
Â  Â  Â  Â  } finally {
Â  Â  Â  Â  Â  Â  isRequirementsLoading = false;
Â  Â  Â  Â  Â  Â  updateUI();
Â  Â  Â  Â  }
Â  Â  };
Â  Â  
Â  Â  // Handle faucet claim transaction
Â  Â  const handleClaim = async () => {
Â  Â  Â  isClaiming = true;
Â  Â  Â  setStatus(`Claiming ${selectedNetwork.nativeCurrency} on ${selectedNetwork.name}...`, 'info');
Â  Â  Â  updateUI();
Â  Â  Â  
Â  Â  Â  try {
Â  Â  Â  Â  // Call your serverless function to perform the faucet claim
Â  Â  Â  Â  const response = await fetch(CLAIM_API_URL, {
Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  headers: { 'Content-Type': 'application/json' },
Â  Â  Â  Â  Â  Â  body: JSON.stringify({
Â  Â  Â  Â  Â  Â  Â  Â  address: account,
Â  Â  Â  Â  Â  Â  Â  Â  networkId: selectedNetwork.id,
Â  Â  Â  Â  Â  Â  Â  Â  amount: selectedNetwork.faucetAmount,
Â  Â  Â  Â  Â  Â  }),
Â  Â  Â  Â  });

Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  Â  const error = await response.json();
Â  Â  Â  Â  Â  Â  throw new Error(error.message || 'Server-side claim failed.');
Â  Â  Â  Â  }

Â  Â  Â  Â  const result = await response.json();
Â  Â  Â  Â  const hash = result.txHash;

Â  Â  Â  Â  const claimedAt = new Date().toISOString();
Â  Â  Â  Â  const newClaim = {
Â  Â  Â  Â  Â  Â  walletAddress: account,
Â  Â  Â  Â  Â  Â  networkId: selectedNetwork.id,
Â  Â  Â  Â  Â  Â  amount: selectedNetwork.faucetAmount,
Â  Â  Â  Â  Â  Â  txHash: hash,
Â  Â  Â  Â  Â  Â  claimedAt: claimedAt,
Â  Â  Â  Â  Â  Â  passportScore: passportData.score.toFixed(2),
Â  Â  Â  Â  Â  Â  isSuccessful: true
Â  Â  Â  Â  };
Â  Â  Â  Â  
Â  Â  Â  Â  // Save the claim to your Upstash instance
Â  Â  Â  Â  await saveLastClaimData(newClaim);
Â  Â  Â  Â  
Â  Â  Â  Â  setStatus(
Â  Â  Â  Â  Â  `âœ… Claim Successful <a href="${selectedNetwork.explorerUrl}/tx/${hash}" target="_blank" class="underline">View Tx</a>`,
Â  Â  Â  Â  Â  'success'
Â  Â  Â  Â  );
Â  Â  Â  Â  
Â  Â  Â  Â  await fetchRequirements();
Â  Â  Â  Â  
Â  Â  Â  } catch (e) {
Â  Â  Â  Â  console.warn('Claim rejected or failed', e);
Â  Â  Â  Â  setStatus(`Claim rejected or failed: ${e.message}`, 'error');
Â  Â  Â  } finally {
Â  Â  Â  Â  isClaiming = false;
Â  Â  Â  Â  updateUI();
Â  Â  Â  }
Â  Â  };
Â  Â  
Â  Â  // Connect using injected/browser wallet
Â  Â  const connectInjectedWallet = async () => {
Â  Â  Â  setStatus('Connecting to browser wallet...');
Â  Â  Â  try {
Â  Â  Â  Â  await connect(wagmiConfig, { connector: wagmiConfig.connectors[0] }); // The first connector is now 'injected'
Â  Â  Â  Â  setStatus('Wallet connected!', 'success');
Â  Â  Â  Â  closeModal();
Â  Â  Â  } catch (e) {
Â  Â  Â  Â  console.error('Browser wallet connect failed', e);
Â  Â  Â  Â  setStatus('Failed to connect with browser wallet. Is a wallet extension installed?', 'error');
Â  Â  Â  }
Â  Â  };
Â  Â  
Â  Â  // Connect using Farcaster mini-app connector
Â  Â  const connectFarcasterWallet = async () => {
Â  Â  Â  setStatus('Connecting with Farcaster...');
Â  Â  Â  try {
Â  Â  Â  Â  await connect(wagmiConfig, { connector: wagmiConfig.connectors[1] }); // Now the second connector
Â  Â  Â  Â  setStatus('Wallet connected with Farcaster!', 'success');
Â  Â  Â  Â  closeModal();
Â  Â  Â  } catch (e) {
Â  Â  Â  Â  console.error('Farcaster connect failed', e);
Â  Â  Â  Â  setStatus('Failed to connect with Farcaster. Please try again.', 'error');
Â  Â  Â  }
Â  Â  };
Â  Â  
Â  Â  // Connect using WalletConnect
Â  Â  const connectWithWalletConnect = async () => {
Â  Â  Â  if (WALLETCONNECT_PROJECT_ID === 'YOUR_WALLETCONNECT_PROJECT_ID') {
Â  Â  Â  Â  setStatus('Please replace the WalletConnect Project ID with a valid one.', 'error');
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â  setStatus('Connecting with WalletConnect...', 'info');
Â  Â  Â  try {
Â  Â  Â  Â  await connect(wagmiConfig, { connector: wagmiConfig.connectors[2] }); // Now the third connector
Â  Â  Â  Â  setStatus('Wallet connected with WalletConnect!', 'success');
Â  Â  Â  Â  closeModal();
Â  Â  Â  } catch (e) {
Â  Â  Â  Â  console.error('WalletConnect failed', e);
Â  Â  Â  Â  setStatus('Failed to connect with WalletConnect. Please try again.', 'error');
Â  Â  Â  }
Â  Â  };
Â  Â  
Â  Â  // Disconnect the current wallet
Â  Â  const disconnectWallet = async () => {
Â  Â  Â  try {
Â  Â  Â  Â  await disconnect(wagmiConfig);
Â  Â  Â  Â  setStatus('Wallet disconnected.', 'info');
Â  Â  Â  } catch (e) {
Â  Â  Â  Â  console.error('Failed to disconnect', e);
Â  Â  Â  Â  setStatus('Failed to disconnect wallet. Please try again.', 'error');
Â  Â  Â  }
Â  Â  };
Â  Â  
Â  Â  // Modal control functions
Â  Â  const openModal = () => {
Â  Â  Â  walletModal.classList.remove('hidden');
Â  Â  Â  walletModal.classList.add('flex');
Â  Â  };
Â  Â  
Â  Â  const closeModal = () => {
Â  Â  Â  walletModal.classList.remove('flex');
Â  Â  Â  walletModal.classList.add('hidden');
Â  Â  };
Â  Â  
Â  Â  // The main function to initialize the app
Â  Â  const init = async () => {
Â  Â  Â  Â  isFarcasterEnv = typeof sdk.actions.ready === 'function';
Â  Â  Â  
Â  Â  Â  Â  // Populate the network selector dropdown
Â  Â  Â  Â  const activeNetworks = getActiveNetworks();
Â  Â  Â  Â  activeNetworks.forEach(network => {
Â  Â  Â  Â  Â  const option = document.createElement('option');
Â  Â  Â  Â  Â  option.value = network.chainId;
Â  Â  Â  Â  Â  option.textContent = network.name;
Â  Â  Â  Â  Â  networkSelector.appendChild(option);
Â  Â  Â  Â  });
Â  Â  Â  Â  
Â  Â  Â  Â  // Set the initial network
Â  Â  Â  Â  selectedNetwork = activeNetworks[0];
Â  Â  Â  Â  networkSelector.value = selectedNetwork.chainId;
Â  Â  Â  Â  updateWagmiConfig(selectedNetwork);
Â  Â  Â  
Â  Â  Â  Â  // Watch for account changes and update UI
Â  Â  Â  Â  watchAccount(wagmiConfig, {
Â  Â  Â  Â  Â  onChange(newAccount) {
Â  Â  Â  Â  Â  Â  isConnected = newAccount.isConnected;
Â  Â  Â  Â  Â  Â  account = newAccount.address;
Â  Â  Â  Â  Â  Â  if (isConnected) {
Â  Â  Â  Â  Â  Â  Â  fetchRequirements();
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  fetchRequirements(); // Call to clear the UI
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  Â  
Â  Â  Â  Â  // Check for an existing connection on page load
Â  Â  Â  Â  const existingAccount = getAccount(wagmiConfig);
Â  Â  Â  Â  isConnected = existingAccount.isConnected;
Â  Â  Â  Â  account = existingAccount.address;
Â  Â  Â  Â  if (isConnected) {
Â  Â  Â  Â  Â  await fetchRequirements();
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  // Listen for network changes
Â  Â  Â  Â  networkSelector.addEventListener('change', async (event) => {
Â  Â  Â  Â  Â  const chainId = parseInt(event.target.value);
Â  Â  Â  Â  Â  selectedNetwork = getNetworkByChainId(chainId);
Â  Â  Â  Â  Â  updateWagmiConfig(selectedNetwork);
Â  Â  Â  Â  Â  await fetchRequirements();
Â  Â  Â  Â  });
Â  Â  Â  Â  
Â  Â  Â  Â  // Event listener for the claim button
Â  Â  Â  Â  claimButton.addEventListener('click', handleClaim);
Â  Â  Â  Â  
Â  Â  Â  Â  // Event listeners for the new wallet connection UI
Â  Â  Â  Â  connectButton.addEventListener('click', openModal);
Â  Â  Â  Â  disconnectButton.addEventListener('click', disconnectWallet);
Â  Â  Â  Â  injectedConnectBtn.addEventListener('click', connectInjectedWallet);
Â  Â  Â  Â  farcasterConnectBtn.addEventListener('click', connectFarcasterWallet);
Â  Â  Â  Â  walletConnectBtn.addEventListener('click', connectWithWalletConnect);
Â  Â  Â  Â  closeModalBtn.addEventListener('click', closeModal);
Â  Â  Â  Â  
Â  Â  Â  Â  // Set up an interval to update the rate limit countdown
Â  Â  Â  Â  setInterval(() => {
Â  Â  Â  Â  Â  if (rateLimitData?.isRateLimited) {
Â  Â  Â  Â  Â  Â  rateLimitData.remainingTime = rateLimitData.nextClaimTime - Date.now();
Â  Â  Â  Â  Â  Â  if (rateLimitData.remainingTime <= 0) {
Â  Â  Â  Â  Â  Â  Â  fetchRequirements(); // Re-fetch data to clear rate limit
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  updateUI();
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }, 1000);
Â  Â  Â  Â  
Â  Â  Â  Â  // Initial UI update
Â  Â  Â  Â  updateUI();
Â  Â  };

Â  Â  document.addEventListener('DOMContentLoaded', init);
Â  </script>
</body>
</html>
